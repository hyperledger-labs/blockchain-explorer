version: '2.4'

services:
  blockchain-explorer:
    build: .
    container_name: explorer.mynetwork.com
    hostname: explorer.mynetwork.com
    environment:
      - DATABASE_HOST=blockchain-explorer-db
      - DATABASE_USERNAME=postgres
      - DATABASE_PASSWD=password
      - DISCOVERY_AS_LOCALHOST=false
      - GOPATH=/opt/explorer/tmp
    volumes:
      - ./app:/opt/explorer/app
      - ./start.sh:/opt/explorer/start.sh
      - ./syncstart.sh:/opt/explorer/syncstart.sh
      - /var/lib/docker/volumes/net_private/_data:/private
      - ./tmp:/opt/explorer/tmp
      - ./logs:/opt/explorer/logs
      - ./swagger.json:/opt/explorer/swagger.json
      - ./client:/opt/explorer/client
    working_dir: /opt/explorer
    command: sh -c "./start.sh && tail -f /dev/null"
    ports:
      - 8080:8080
      - 9229:9229
    networks:
      - fabric-ca
